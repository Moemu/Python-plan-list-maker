#By WhitemuTeam
#Ver: 3.0(Pro)
#初始化
week=0 
import PySimpleGUI as sg

#一言句子获取（随机分类）
def hitokoto():
    import requests as r
    try:
        web=r.get('https://v1.hitokoto.cn/?encode=text')
        web.encoding='utf-8'
        sen=web.text
        return sen
    except:
        sg.popup('请检查您的网络设置，如是否启用代理，如开启，请将其关闭')
        exit()

#自定义文本句子获取(sen.txt)
#取自issue #1(By AdminWhaleFall)

def txt():
    import random
    with open('sen.txt', 'r' , encoding='utf8') as f:
        datas = f.readlines()
        data  =  random.choice(datas)
    if data.strip() == '':
        txt()
    else:
        return data.strip() 
      
if __name__ == '__main__':
        sen = txt()

sg.theme('SystemDefaultForReal') #这是PysimpleGUI的主题之一，如果您不喜欢此主题，请参阅 https://blog.csdn.net/gainiu/article/details/113808314 查看其他主题

#GUI界面配置
layout=[[sg.Text('1*.请输入自定义标题，输入格式参阅readme.md(不填为Week)')],
        [sg.Input()],
        [sg.Text('2.请输入页数(必填)')],
        [sg.Input()],
        [sg.Text('3.请选择句子获取方式')],
        [sg.Radio('一言API', group_id=1),
        sg.Radio('自定义句子(sen.txt)', group_id=1)],
        [sg.Button('提交')]]

event,value=sg.Window('Plan list making(GUI)',icon='LOGO.ico').Layout(layout).Read() #启动GUI并获取值

#获取标题
tit=value[0]
if tit=='':
    tit='Week'

#获取制作数量
page=int(value[1])

#读取句子获取方法
way=value[2]

#创建weekplan.md
doc=open('weekplan.md','w')
#导出
while (page > 0):
    week=week+1
    if way==True:
        sen=hitokoto()
    else:
        sen=txt()
    print('# ',tit ,week,file=doc) #标题（默认为Week，可更改为Day，例如:'#Day ',week）
    print(sen,file=doc) #引用句子
    print('# **□** **1. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **2. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **3. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **4. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **5. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **6. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **7. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **8. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **9. _______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **10. ______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **11. ______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **12. ______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **13. ______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **14. ______________________________________________________________________________________________________________________________**',file=doc)
    print('# **□** **15. ______________________________________________________________________________________________________________________________**',file=doc)
    #每日小结（可自行选择删除）
    print('# 小结：',file=doc)
    print('# **________________________________________________________________________________________________________________________________________________**',file=doc)
    print('# **________________________________________________________________________________________________________________________________________________**',file=doc)
    print('# **________________________________________________________________________________________________________________________________________________**',file=doc)
    page=page-1

doc.close()
sg.popup('导出完成，请打开weekplan.md查看',icon='LOGO.ico')
#end
